---
title: Cache & Cookie
categories: Dev
date: 2018-08-15 01:47:58
tag:
---

# Cache & Cookie

## 쿠키와 캐시의 차이점

1. 유저의 컴퓨터에 임시로 저장되어 있는 점은 같지만, 사용목적이 다르다.

   1. 캐시: 같은 웹사이트를 반복 접속 시 페이지 로딩 속도를 개선하고, 데이터를 줄임.
   2. 쿠키: 유저의 행동 패턴을 주로 저장하는 작은 사이즈의 텍스트 파일

   

2. 목적이 다르다.

   1. 캐시: 오직 웹페이지 로딩 속도 개선을 위해 사용됨
   2. 쿠키: 유저 관련 여러가지 다른 목적으로 사용가능하다.

   

3. 저장하는 내용이 다르다.

   1. 캐시: 오디오 비디오 등 리소스 파일등을 주로 저장
   2. 쿠키: 유저의 행동패턴 위주의 정보를 저장

   

4. 보통 삭제시점이 다르다.

   1. 캐시: 유저가 삭제할 때 까지 유저 컴퓨터에 저장됨
   2. 쿠키: 서버 쪽에서 설정한 기간이 지나면 자동으로 삭제됨.

   

5. 웹서버 Access 접근 유무

   1. 캐시: 웹서버 Access 불가능.
   2. 쿠키: 웹서버 Access 가능.



# 쿠키

## 쿠키의 정의

인터넷 사용자가 특정 웹사이트를 방문할 경우 그 사이트가 사용하는 서버를 통해 인터넷 사용자의 컴퓨터에 설치하는 작은 정보 파일을 일컫는다. 

쿠키: 사용자가 특정 사이트를 접속할 때 생성되는 정보를 담아두는 임시 파일, 크키는 4KB.

쿠키는 주로 사이트접속기록, 검색기록 , 최근 열어본 문서기록, 개인정보(id, password) 등을 저장한다.

**쿠키**는 일정 시간동안 데이터를 저장할 수 있어서 로그인 상태를 유지하거나 사용자 정보를 일정 시간 동안 유지해야 하는 경우에 주로 사용된다.



쇼핑정보, 로그인, 



## 쿠키를 이용한 Stateful 통신의 과정

1. 최초 통신에서 클라이언트가 서버의 쿠키를 가지고 있지 않은 상태에서 Request함.
2. 서버는 Request의 헤더에 쿠키가 포함되어 있지 않은 것을 판단하고, 통신의 상태(User ID, Password, 조작상태, 방문횟수 등)을 저장한 쿠키를 Response
3. 클라이언트의 브라우저가 받은 쿠키를 보존한다.
4. 두 번재 연결에서 HTTP 헤더에 쿠키를 싣고 서버에 Request한다.
5. 서버는 받은 쿠키로부터 클라이언트를 판별한다.



## 쿠키의 제약조건

* 클라이언트는 총 300개의 쿠키를 저장할 수 있다.
* 하나의 도메인 당 20개의 쿠키를 가질 수 있다.
  * 하나의 도메인에서 쿠키 갯수가 20개를 넘기면, 가장 적게 사용되는 쿠키부터 삭제한다.
  * 쿠키는 텍스트 형식으로 저장되고, 쿠키가 사라지는 시점은 쿠키를 저장할 때 설정할 수 있고, 설정하지 않으면 해당 브라우저 종료 시 삭제된다.
* 하나의 쿠키는 4096byte까지 저장할 수 있다.



## 쿠키의 구성요소

| 구성요소 | 역할                               | 예시                                                         |
| -------- | ---------------------------------- | ------------------------------------------------------------ |
| Name     | 쿠키의 이름                        |                                                              |
| Value    | 쿠키의 저장 값                     |                                                              |
| Expires  | 쿠키가 언제 삭제되는지 결정        | `expires="Wdy, DD−Mon−YYYY HH:MM:SS GMT"`<br />쿠키에 만료일이 포함되어 있으면 영구적 쿠키로 간주. <br /> `Max-Age`를 통해 지정된 만료일이 되면 디스크에서 쿠키가 제거. |
| Path     | 쿠키를 반환할 경로를 결정          | ` path=/`<br />: 도메인의 루트 경로로 이동할 경우 쿠키가 전송 |
| Secure   | 보안 연결 설정                     |                                                              |
| HttpOnly | Http외에 다른 통신 사용 가능 설정. |                                                              |



## 쿠키의 종류

| 쿠키이름           | 특징                                                         |
| ------------------ | ------------------------------------------------------------ |
| Session Cookie     | 보통 만료시간을 설정하고 메모리에만 저장되며 브라우저 종료시 쿠키를 삭제. |
| Persistent Cookie  | 장기간 유지되는 쿠키(예를 들어 Max-Age 1년), 파일로 저장되어 브라우저 종료와 관계없이 사용. |
| Secure Cookie      | HTTPS에서만 사용, 쿠키 정보가 암호화 되어 전송.              |
| Third-Party Cookie | 방문한 도메인과 다른 도메인의 쿠키 보통 광고 베너 등을 관리할 때 유입 경로를 추적하기 위해 사용. |
| Same-site cookie   |                                                              |
| Supercookie        |                                                              |
| Zombie cookie      | 삭제 후에도 자동으로 재생성되는 쿠키다. 이런 일은 클라이언트 측 스크립트의 도움이 있기에 가능하다. 이 스크립트는 [플래시 로컬 저장소](http://en.wikipedia.org/wiki/Adobe_Flash_Player#Privacy), HTML5 저장소, 그리고 다른 클라이언트 측 저장소 위치와 같은 여러 곳에 쿠키의 내용을 저장함으로써 시작한다. 스크립트가 쿠키가 없음을 알아차리면 각 위치에 저장되어 있는 데이터를 사용해 쿠키를 재생성한다. |

 

## 쿠키의 단점

- 쿠키에 대한 정보를 매 헤더(Http Header)에 추가하여 보내기 때문에 `상당한 트랙픽`을 발생시킵니다.
- 결제정보등을 쿠키에 저장하였을때 쿠키가 유출되면 `보안에 대한 문제점`도 발생할 수 있습니다.

 



# 캐시

## 캐시의 정의

캐시란, 클라이언트가 요청한 HTML, IMAGE, JS, CSS 등에 대해 첫 요청 시 파일을 내려받아 특정 위치에 복사본을 저장하고, 이후 동일한 URL의 Resource 요청은 다시 내려받지 않고, 내부에 저장한 파일을 사용하여 빠르게 서비스하기 위한 것입니다. 서비스를 통해 내려받는 양이 적어지니, 응답시간이 감소하고 네트워크 트래픽이 감소되니 Server와 Client 모두가 윈-윈 할 수 있는 최고의 Trade-Off입니다.



웹 사이트에 처음 접속할 때 로드되는 시간이 많이 소요되었으나, 차후 같은 사이트를 방문해 페이지를 열 때 로드되는 시간이 상당히 단축되어지는데, 이는 캐시 정보 때문이다.

사용자가 지난 번에 호출한 정보에 대한 기록을 캐시 저장소에서 자동 저장하여 재호출 시 서버의 주 메모리가 다시 일일이 계산할 필요없이 이미 계산되어 있는 캐시의 정보를 그대로 전송하므로, 속도를 줄일 수 있다

캐시는 브라우저에 생성이 되는데, 캐시에는 자주 쓰이는 이미지 파일 등 비교적 큰 데이터 파일들이 저장된다. 웹 페이지 하나를 띄우기 위해 서버에서 보내는 데이터의 양은 적지 않다. 이 때 수비게 바뀌지 않는 이미지 파일이나 데이터들이 캐시에 저장된다.

 우리가 웹페이지를 서버로부터 받았을 때 어느 부분에 띄워야 할 이미지나 데이터 등을 처음 접속했을 다잇에 받아서 캐시에 저장을 해 놓고 캐시에서 갖다 쓴다. 매 번 서버에서 보내준다면 비교적 많은 양의 데이터가 오고 갈 것이지만 캐시에 저장을 해 둔다면 비교적 적은 양의 데이터를 사용하며 웹페이지를 띄울 수 있다. 



## 캐시의 종류

* Browser Caches
* Proxy Caches
* Gateway Caches









